<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 5.1.6.2 (Linux)"/>
	<meta name="author" content="Monster "/>
	<meta name="created" content="2014-10-24T18:38:51"/>
	<meta name="changed" content="2017-04-18T15:16:35.696815487"/>
	<style type="text/css">
		@page { margin: 0.79in }
		p { margin-bottom: 0.08in }
		h3 { margin-top: 0.17in }
		h3.western { font-family: "Liberation Sans", sans-serif }
		h3.cjk { font-family: "Droid Sans" }
		h3.ctl { font-family: "FreeSans" }
		td p { margin-bottom: 0in }
		a.cjk:link { so-language: zxx }
		a.ctl:link { so-language: zxx }
		a.western:visited { so-language: en-US }
	</style>
</head>
<body lang="en-US" dir="ltr">
<div title="header">
	<p style="margin-bottom: 0.2in"><br/>

	</p>
</div>
<div id="Table of Contents1" dir="ltr">
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__697_1754408385">Introduction	2</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__804_1754408385">Accounts	3</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__807_1754408385">Adaptive
	Echo	4</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__186_1525007520">Block
	Cipher Modes of Operation	5</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1165_1635037974">Capabilities
	Sharing	6</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__810_1754408385">Communication
	Methods	7</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__297_1157459078">Communication
	Model	8</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1909_830128324">Communication
	Sessions	9</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1856_112550698">Compilation
	Process	10</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__283_2127962396">Configuration
	Settings	11</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__813_1754408385">Constant-Time
	Comparison Function	12</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__816_1754408385">Echo	13</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__651_817640049">Echo
	Public Key Sharing	14</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__266_198272384">Electronic
	Mail	15</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc649_890794201">Electronic
	Mail Forward Secrecy	16</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__819_1754408385">Encrypted
	and Authenticated Containers	17</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__603_490309552">File
	Encryption	18</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1120_495770474">Fragmented
	StarBeams	19</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__822_1754408385">Key
	Derivation	20</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__210_1274879713">Hybrid
	System	21</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1332_384061765">Local
	Private Application Interfaces	22</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1246_1817743241">McEliece	23</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__299_1157459078">Multiple
	Devices	25</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1195_307987230">Non-Volatile
	Congestion Control Memory	26</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1209_1984784944">NTL	27</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1036_18893826">Pass-through
	Devices	28</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__253_527466761">Poptastic	29</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__169_1115980955">Public
	Key Infrastructure	30</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1516_1997043320">Public
	Key Sharing	31</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1373_1503577792">Secure
	Memory	32</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc631_61244466">Sessions	33</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__330_678579420">Socialist
	Millionaire Protocol	34</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc1097_1460767439">Sources
	of Entropy	35</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading__230_1536820662">Two-Way
	Calling	36</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc842_866388615">Verifying
	Ownership of Public Keys	37</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc839_866388615">Wide
	Lanes	39</a></p>
	<p style="margin-left: 0.39in; margin-bottom: 0in"><a class="western" href="#__RefHeading___Toc748_390620771">References	40</a></p>
</div>
<p style="margin-bottom: 0in"><br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__697_1754408385"></a>
Introduction</h3>
<p align="left" style="margin-bottom: 0in">Spot-On is a
fruit-propelled science project. The software is composed of two
separate applications, a multi-threaded kernel and a user interface.
The two applications are written in C++ and require the Qt framework
as well as an assortment of libraries. Qt versions 4.8.x and Qt 5.x
are supported. Spot-On is available on FreeBSD, Linux, OS X, OS/2,
and Windows. In addition to supporting the x86 and x86-64
architectures, ARM and PowerPC are also supported without any special
provisions. It’s anticipated that Spot-On is fully functional on
the SPARC architecture.</p>
<p align="left" style="margin-bottom: 0in"><br/>

</p>
<p align="left" style="margin-bottom: 0in">Please note that the Echo
algorithm and its name are not derived from Ernest J. H. Chang's 1982
Echo Algorithms: Depth Parallel Operations on General Graphs paper.</p>
<p align="left" style="margin-bottom: 0in"><br/>

</p>
<p align="left" style="margin-bottom: 0in">Software source is
available at <a class="western" href="https://github.com/textbrowser/spot-on">https://github.com/textbrowser/spot-on</a>.</p>
<p align="left" style="margin-bottom: 0in"><br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__804_1754408385"></a>
Accounts</h3>
<p align="left">Spot-On implements a plain, and perhaps original,
two-pass mutual authentication protocol. The implementation is
well-defined with or without SSL/TLS. Synchronized clocks are
required. The protocol is weakened if trusted SSL/TLS is neglected,
however. Please see the paragraph at the end of this section for
additional details regarding the weakness. The Accounts procedure is
as follows:</p>
<ol>
	<li/>
<p align="left">Binding endpoints are responsible for defining
	account information. During the account-creation process, an account
	may be designated for one-time use. Account names and account
	passwords each require at least 32 bytes of data.</p>
	<li/>
<p align="left">After a network connection is established, a
	binding endpoint notifies the peer with an authentication request.
	The binding endpoint will terminate the connection if the peer has
	not identified itself within a fifteen-second window.</p>
	<li/>
<p align="left">After receiving the authentication request,
	the peer responds to the binding endpoint. The peer submits the
	following information: H<sub>Hash Key</sub>(Salt || Time) || Salt,
	where the Hash Key is a concatenation of the account name and the
	account password. The SHA-512 hash algorithm is presently used to
	generate the hash output. The Time variable has a resolution of
	minutes. The peer retains the salt value. Please note that the peer
	may submit credentials without having received an authentication
	request. This is acceptable.</p>
	<li/>
<p align="left">The binding endpoint receives the peer's
	information. Subsequently, it computes H<sub>Hash Key</sub>(Salt ||
	Time) for all of the accounts that it possesses. If it does not
	discover an account, it increments Time by one minute and performs
	an additional search. If an account is discovered, the binding
	endpoint creates a message similar to the message created by the
	peer in the previous step and submits the information to the peer:
	H<sub>Hash Key</sub>(Salt || Salt<sub>3</sub> || Time) || Salt. The
	authenticated information is recorded. After a period of
	approximately 120 seconds, the information is discarded.</p>
	<li/>
<p align="left">The peer receives the binding endpoint's
	information and performs a similar validation process, including the
	analysis of the binding endpoint's salt. The two salt values must be
	distinct. The peer will terminate the connection if the binding
	endpoint has not identified itself within a fifteen-second window.
	Peers will ignore unsolicited authentication requests.</p>
</ol>
<p align="left">Please note that the Accounts system may be promoted
by including an encryption key. The additional key will allow for
finer time resolutions.</p>
<p align="left">If SSL/TLS is not available, the protocol may be
exploited. A relay station may record the values in the 3<sup>rd</sup>
step and subsequently provide the information to the binding
endpoint. The binding endpoint will therefore trust the foreign
connection. The recording device may then seize the binding
endpoint's response, the values in the 4<sup>th</sup> step, and
provide the information to the peer. If the information is accurate,
the peer will accept the binding endpoint's response. Therefore, the
Accounts protocol is susceptible to impersonation.</p>
<p align="left">The use of nonces and timestamps, in conjunction with
congestion control and the retaining of distributed nonces, should
prevent re-ordering, reflection, and replay attacks.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__807_1754408385"></a>
Adaptive Echo</h3>
<p align="left">The Adaptive Echo is a complement to the Echo and
substantiates the opinion that the Echo is a malleable method.
Endpoints that bind multiple parties may optionally define Adaptive
Echo tokens. Adaptive Echo tokens are composed of authentication and
encryption keys as well as details about the choice algorithms. If
configured, binding endpoints are able to permit or restrict
information travel based on the content of the data. As an example,
peers that are cognizant of a specific Adaptive Echo token will
receive data from other cognizant peers whereas traditional peers
will not. Binding endpoints therefore selectively-echo data.</p>
<p align="left">The Adaptive Echo behaves as follows:</p>
<ol>
	<li/>
<p align="left">A binding endpoint defines an Adaptive Echo
	token. The information must be distributed securely.</p>
	<li/>
<p align="left">A networked peer having the given Adaptive
	Echo token generates H<sub>Hash Key</sub>(E<sub>Encryption
	Key</sub>(Message || Time)) || E<sub>Encryption Key</sub>(Message ||
	Time) where the Encryption Key and Hash Key are derived from the
	Adaptive Echo token. The generated information is then submitted to
	the binding endpoint as Message || Adaptive Echo Information.</p>
	<li/>
<p align="left">The binding endpoint processes the received
	message to determine if the message is tagged with a known Adaptive
	Echo token. If the message is indeed tagged correctly, the Time
	value is inspected. If the Time value is within five seconds of the
	binding endpoint's local time, the message is considered correct and
	the peer's presence is recorded.</p>
	<li/>
<p align="left">As the binding endpoint receives messages from
	other peers, it inspects the messages to determine if the messages
	have been tagged with Adaptive Echo tokens. This process creates a
	network of associated peers. Because peers themselves may be binding
	endpoints, the Adaptive Echo may be used to generate an artificial
	trust network.</p>
</ol>
<p align="left">Adaptive Echo is susceptible to eavesdropping. As an
example, if a message that is tagged with an Adaptive Echo token
should travel through one or more peers to reach a destination, the
peers may record the message and subsequently replay the message to a
binding peer. The replay must occur within the acceptance window of
the message. Additionally, the binding endpoint's congestion control
container must not already contain the message. If both conditions
are met, the binding endpoint will consider the peer as trustworthy.</p>
<p align="left"><br/>
<br/>

</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__186_1525007520"></a>
Block Cipher Modes of Operation</h3>
<p align="left">Spot-On uses CBC with CTS to provide confidentiality.
The file encryption mechanism supports the GCM algorithm without the
authenticity property that's provided by the algorithm. To provide
authenticity, the application uses the encrypt-then-MAC (EtM)
approach. The Encrypted and Authenticated Containers section provides
more details.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1165_1635037974"></a>
Capabilities Sharing</h3>
<p align="left">Peers may exchange capabilities information.
Currently, the information includes the UUID, the echo mode, and the
preferred lane width. Please note that a server socket must adhere to
its peer's settings. Although an administrator may modify the echo
mode and the lane width on a particular socket (remote neighbor), the
kernel will override the settings so as to conform to the client's
preferences.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__810_1754408385"></a>
Communication Methods</h3>
<p align="left">Spot-On supports Bluetooth, SCTP, TCP, and UDP
(multicast and unicast) communication methods. Both IPv4 and IPv6 are
totally supported. Some communications portions also support a
variety of proxies. For TCP-based communications, OpenSSL is
supported. Spot-On distributes data with or without SSL/TLS. Please
note that magnet distribution violates this principle and therefore
requires SSL/TLS. Communications between the Spot-On Kernel and the
Spot-On User Interface also require SSL/TLS via TCP. In essence, the
application is generally transport-neutral.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__297_1157459078"></a>
Communication Model</h3>
<p align="left" style="font-weight: normal">Spot-On mostly assumes an
asynchronous communication model. The Accounts, SMP, and Two-Way
Calling systems require responses.</p>
<p align="left" style="font-weight: normal"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1909_830128324"></a>
Communication Sessions</h3>
<p align="left">This section describes some common methods which may
be employed against Spot-On in an attempt to destabilize the
communications of two parties.</p>
<p align="left">Various attack methods include: flood attack,
re-ordering attack, reflection attack, and replay attack.</p>
<p align="left">Public Spot-On devices are susceptible to flood
attacks.</p>
<p align="left">Save for <a class="western" href="#__RefHeading___Toc1332_384061765">Local
Private Application Interfaces</a>, Spot-On does not guarantee
orderly delivery of data and is therefore susceptible to <b>re-ordering</b><span style="font-weight: normal">.
However, </span><span style="font-weight: normal">this attack method</span><span style="font-weight: normal">
is not considered detrimental </span><span style="font-weight: normal">as
Spot-On is not orderly.</span><span style="font-weight: normal"> </span><span style="font-weight: normal">Some
sub-systems such as Accounts and SMP </span><span style="font-weight: normal">should
be resistant to this particular attack.</span></p>
<p align="left" style="font-weight: normal">In a <b>reflection
attack</b>, an adversary may capture a message sent from party A to
party B and return the message to party A. For this attack to be
successful in messages involving public keys, it must be possible for
the originator of the message to be able to decipher its original
message. Private-key communications are susceptible to reflection
attacks, however, properly-defined congestion control and timestamps
should aid against reflection attacks.</p>
<p align="left" style="font-weight: normal">In a <b>replay attack,</b>
an adversary may replay a valid message. Discounting congestion
control, the message may appear as if it was sent recently. All
private-key portions of Spot-On contain timestamps. Congestion
control and timestamps should provide some resistance against replay
attacks.</p>
<p align="left" style="font-weight: normal">Computing and memory
resources are required to prevent the aforementioned attacks.</p>
<p align="left" style="font-weight: normal"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1856_112550698"></a>
Compilation Process</h3>
<p align="left">Spot-On builds are not digest-reproducible as the
compilation process embeds the date and time of the compilation. In
order to produce digest-reproducible builds, the
SPOTON_DATELESS_COMPILATION option should be enabled during the
generation of the project files. For example, qmake
DEFINES+=SPOTON_DATELESS_COMPILATION -o Makefile spot-on.qt5.pro.</p>
<p align="left">One should then expect results similar to the
following.</p>
<p align="left">date &amp;&amp; sha512sum ./Spot-On ./Spot-On-Kernel</p>
<p align="left">Fri Jan  6 10:27:21 2017</p>
<p align="left">0fbcf8e8a82dacd9825c42cf88d2d5a70d87965da20a3bfc5f87b8f634e0219567ecd42a01a30b55aed438d6c55ab1d4a6d7ea62fe7a65ac461874f1f1c5de59
 ./Spot-On</p>
<p align="left">0cf523d52de5f50ec01e7f442c0f374ac15b6432757f17ac93df26f88784d5819f27101a10a6e765b4d7e8ca420b7c110e822dc835ad0083b339b64f1431ec81
 ./Spot-On-Kernel</p>
<p align="left">date &amp;&amp; sha512sum ./Spot-On ./Spot-On-Kernel</p>
<p align="left">Fri Jan  6 10:28:47 2017</p>
<p align="left">0fbcf8e8a82dacd9825c42cf88d2d5a70d87965da20a3bfc5f87b8f634e0219567ecd42a01a30b55aed438d6c55ab1d4a6d7ea62fe7a65ac461874f1f1c5de59
 ./Spot-On</p>
<p align="left">0cf523d52de5f50ec01e7f442c0f374ac15b6432757f17ac93df26f88784d5819f27101a10a6e765b4d7e8ca420b7c110e822dc835ad0083b339b64f1431ec81
 ./Spot-On-Kernel</p>
<p align="left">Non-digest-reproducible builds will generate distinct
results.</p>
<p align="left">date &amp;&amp; sha512sum ./Spot-On ./Spot-On-Kernel</p>
<p align="left">Fri Jan  6 10:30:43 2017</p>
<p align="left">4ccc44773bd43086941dd26f02b82e2eca7972f768844a544d23c19fedf6ed407911a73af4493c546c9bf94ec60afd69c5e0a646e8f9378c75811f4b4d36ef9e
 ./Spot-On</p>
<p align="left">90720de4702bd5df97ce1af6ec5fd8ec206b279fecff37200f5bad5849e4e1183131ef7492a3a94f45db648ea415184e1ab89da76e7ca9d493738de37e6a8bb5
 ./Spot-On-Kernel</p>
<p align="left">date &amp;&amp; sha512sum ./Spot-On ./Spot-On-Kernel</p>
<p align="left">Fri Jan  6 10:32:10 2017</p>
<p align="left">ea6275a644d1cd589510907929d8133b9e4557abca8c19aa4523887d0efe2b084f24b80216e5b3c889d23d0071afbac1933b772bae5f7cdbb58bd383be4a4a8e
 ./Spot-On</p>
<p align="left">51d59a7dccd39a34183eeb200e2658d3d77a24e4ca5facbb9ee95fb8f32dbb7434f2d354342c5d7fefd0104feeda45fad6a9fe33a81ee6cd5cf76619a44932e5
 ./Spot-On-Kernel</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__283_2127962396"></a>
Configuration Settings</h3>
<p align="left">Spot-On implements a defensive approach with respect
to configuration settings. Shortly after the kernel and the user
interface are started, important settings are reviewed and if
necessary corrected. The potentially-adjusted values are stocked in
global containers. Some methods also inspect critical values,
adjusting them if necessary.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__813_1754408385"></a>
Constant-Time Comparison Function</h3>
<p align="left">Spot-On attempts to utilize constant-time byte
comparison functions so as to avoid timing analysis. Comparisons that
occur within database queries are not guaranteed to be constant-time.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__816_1754408385"></a>
Echo</h3>
<p align="left">Spot-On introduced the Echo. The Echo is a malleable
concept. That is, an implementation does not require rigid details.
Each model may adhere to their own peculiar obligations. The Echo
functions on the elementary persuasion that information is dispersed
over multiple or singular passages and channel endpoints evaluate the
suitability of the received data. Because data may become
intolerable, Spot-On implements its own congestion control algorithm.
Received messages that meet some basic criteria are labeled and
duplicates are discarded. Advanced models may define more
sophisticated congestion-avoidance algorithms based upon their
interpretations of the Echo.</p>
<p align="left">Spot-On provides two modes of operation for the
general Echo, Full Echo and Half Echo. The Full Echo permits absolute
data flow. The Half Echo defines an agreement between two endpoints.
Within this agreement, information from other endpoints is prohibited
from traveling along the private channel.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__651_817640049"></a>
Echo Public Key Sharing</h3>
<p align="left">The Echo Public Key Sharing construct was introduced
by Mr. Schmidt. It is an elegant compliment to the Echo. The concept
may be summarized as follows:</p>
<ol>
	<li/>
<p align="left">A community is created. The community is
	defined by a pair of authentication and encryption keys. The keys
	are derived via the PBKDF2 function.</p>
	<li/>
<p align="left">Public key pairs may be optionally exchanged
	via the community. Participants who subscribe to a well-defined
	community will automatically accept public key pairs from
	participants who have published their public keys to the respective
	community.</p>
</ol>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__266_198272384"></a>
Electronic Mail</h3>
<p align="left">Spot-On provides two e-mail models for distributed
e-mail. Endpoints may optionally define themselves as institutions or
post offices, or both.</p>
<p align="left">A brief description of e-mail institutions follows.
E-mail institutions are artificially characterized by addresses and
names. The information is not considered secret and several endpoints
may identify themselves identically. It is the responsibility of an
institution to define subscribers. The data that an institution
houses is stored in encrypted containers. Unlike physical
institutions, Spot-On institutions are only allowed to read the
signature portions of e-mail letters. The signatures allow
verification of deposits and withdrawals.</p>
<p align="left">One important difference between e-mail institutions
and e-mail post offices is that post offices require the distribution
of public keys.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc649_890794201"></a>
Electronic Mail Forward Secrecy</h3>
<p align="left">This section briefly describes a two-step
communication process for establishing forward secrecy in Spot-On
e-mail. We assume a hybrid scheme with respect to public-key
encryption.</p>
<p align="left">Assumptions:</p>
<ol>
	<li/>
<p align="left">Permanent public key pairs have been exchanged
	correctly.</p>
	<li/>
<p align="left">The respective kernels remain active during
	the exchange window.</p>
</ol>
<p align="left">Protocol:</p>
<ol>
	<li/>
<p align="left">Participant A generates an ephemeral public
	encryption key pair. The key pair's attributes are configurable. If
	the kernel is deactivated after the key pair is generated, the key
	pair is discarded and the protocol is terminated.</p>
	<li/>
<p align="left">Participant A transmits the ephemeral public
	key to B. The key is encrypted with B's permanent encryption public
	key and optionally signed with A's permanent private signature key.</p>
	<li/>
<p align="left">B receives the public key and optionally
	verifies the signature. If B requires a valid signature but one is
	not provided, the protocol is terminated.</p>
	<li/>
<p align="left">B generates private authentication and
	encryption keys.</p>
	<li/>
<p align="left">Using the ephemeral public encryption key, B
	transfers the keys to A. The complete bundle is encrypted with A's
	permanent encryption public key and optionally signed with B's
	permanent private signature key.</p>
	<li/>
<p align="left">Participant A receives the bundle and
	optionally verifies the signature. If A requires a valid signature
	but one is not provided, the protocol is terminated.</p>
</ol>
<p align="left">The session keys generated in the fourth step may
remain in use until one of the parties decides to establish new
session keys.</p>
<p align="left">Signatures are required over the Poptastic transport.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__819_1754408385"></a>
Encrypted and Authenticated Containers</h3>
<p>Some of the data that Spot-On retains locally is stored in
encrypted and authenticated containers. CBC and CTS encryption modes
are used with a variety of block ciphers. Authentication and
encryption occur as follows:</p>
<ol>
	<li/>
<p>If the size of the original data is less than the specified
	cipher's block size, the original data is re-sized such that its new
	size is identical to the cipher's block size. A zero-byte pad is
	applied.</p>
	<li/>
<p>Append the size of the original data to the
	potentially-padded container.</p>
	<li/>
<p>Encrypt the augmented data via the selected cipher and
	specified mode.</p>
	<li/>
<p>Compute a keyed-hash of the encrypted container.</p>
	<li/>
<p>Concatenate the hash output with the encrypted data, H<sub>Hash
	Key</sub>(E<sub>Encryption Key</sub>(Data || Random || Size(Data)))
	|| E<sub>Encryption Key</sub>(Data || Random || Size(Data)).</p>
</ol>
<p>Spot-On also includes a mechanism for re-encoding data if new
authentication and encryption keys are desired.</p>
<p><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__603_490309552"></a>
File Encryption</h3>
<p align="left">Spot-On includes a simple file encryption
application. A PIN and secret are used for generating authentication
and encryption keys. After the initial encryption key is derived and
applied, a subsequent encryption key is derived via a single-round
PBKDF2 using the current key as the secret and the encrypted data as
the salt. Several encryption and hash algorithms are supported as
well as various encryption modes.</p>
<p align="left">The format of the converted file is as follows:</p>
<table width="100%" cellpadding="4" cellspacing="0">
	<col width="85*">
	<col width="85*">
	<col width="85*">
	<tr valign="top">
		<td width="33%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="left">Byte 0: 0 – unsigned file, 1 – signed file</p>
		</td>
		<td width="33%" style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
			<p align="left">Bytes 1 – 64: keyed hash or 64 bytes of zeros</p>
		</td>
		<td width="33%" style="border: 1px solid #000000; padding: 0.04in">
			<p align="left">Bytes 65 – EOF: encrypted data</p>
		</td>
	</tr>
</table>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1120_495770474"></a>
Fragmented StarBeams</h3>
<p align="left">Fragmented StarBeams allow for the fragmentation of a
mosaic (file) into a number of N unique pulses, where N is the number
of active network connections. The standard StarBeam transfers copies
of a particular pulse over each network connection.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__822_1754408385"></a>
Key Derivation</h3>
<p align="left">Spot-On uses separate authentication and encryption
keys for local data. The key-derivation process is as follows:</p>
<ol>
	<li/>
<p align="left">Generate a cryptographic salt. The size of the
	salt is configurable.</p>
	<li/>
<p align="left">Derive a temporary key via the PBKDF2
	function. The hash algorithm, iteration count, passphrase
	(question/answer), and salt are input parameters to the function.
	All of the aforementioned parameters are configurable.</p>
	<li/>
<p align="left">Using the temporary key from the previous
	step, derive a new key via the PBKDF2 function. The previous
	parameters are also used, however, the temporary key replaces the
	passphrase (question/answer).</p>
	<li/>
<p align="left">Separate the derived key into two distinct
	keys. The encryption key is N bytes long, where N is the recommended
	key size of the selected cipher. The remaining bytes compose the
	authentication key. The generated authentication key contains at
	least 512 bytes.</p>
</ol>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__210_1274879713"></a>
Hybrid System</h3>
<p align="left">Spot-On implements a hybrid system for authenticity
and confidentiality. Per-message authentication and encryption keys
are generated. The two keys are used for authenticating and
encapsulating data. The two keys are encapsulated via the public-key
portion of the system. The application also provides a mechanism for
distributing session-like keys for data encapsulation. The private
keys are encapsulated via the public-key system. An additional
mechanism allows for the distribution of session-like keys via
previously-established private keys. Digital signatures are
optionally applied to the data. As an example, please consider the
following message: E<sub>Public Key</sub>(Encryption Key || Hash Key)
|| E<sub>Encryption Key</sub>(Data) || H<sub>Hash Key</sub> (E<sub>Public
Key</sub>(Encryption Key || Hash Key) || E<sub>Encryption Key</sub>(Data)).
The private-key authentication and encryption mechanism is identical
to the procedure discussed in the Encrypted and Authenticated
Containers section.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1332_384061765"></a>
Local Private Application Interfaces</h3>
<p align="left">Spot-On supports the concept of local private
application interfaces. The interfaces allow networked applications
to stream authenticated and encrypted data through a Spot-On network.
Application-native cryptographic capabilities are not required. A
local listener, such as 127.0.0.1:4710, should be defined per
application. Once defined, credentials may be prepared for the
listener. Let’s review:</p>
<ol>
	<li/>
<p align="left">Decide on the interface of the application.
	That is, Bluetooth, TCP, etc. Does it require SSL/TLS?</p>
	<li/>
<p align="left">Create a local private listener, say
	127.0.0.1:4710.</p>
	<li/>
<p align="left">Enable the passthrough setting on the
	listener.</p>
	<li/>
<p align="left">Prepare the pseudo-private credentials via a
	context menu.</p>
	<li/>
<p align="left">Distribute the credentials to your partners.
	Remember, these are not necessarily private credentials. However,
	let’s consider them as such.</p>
	<li/>
<p align="left">Initiate the Spot-On kernel process.</p>
	<li/>
<p align="left">Connect your application to the
	previously-defined listener.</p>
</ol>
<p align="left">Do remember that if Spot-On is on a public network,
data will arrive through the public interface(s). However, your
networked application will only receive applicable data; that is,
data that was encapsulated by your credentials.</p>
<p align="left">Please note that listeners may be defined such that
remote access is possible. For example, one may define
192.168.178.100:4710. A similar approach may be used to define
private-application neighbors.</p>
<p align="left">Some other interesting conclusions follow.</p>
<p align="left">Adaptive echoes are not supported on
private-application interfaces.</p>
<p align="left">Applications may not be able to support Spot-On
accounts. Therefore, Spot-On accounts are not observed for
private-application listeners.</p>
<p align="left">Echo modes and lane widths are regarded.</p>
<p align="left">If congestion control becomes an issue, you may wish
to prolong the congestion timer.</p>
<p align="left">Spot-On guarantees ordered data delivery.</p>
<p align="left">Strange behavior may occur if multiple applications
share a common channel.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1246_1817743241"></a>
McEliece</h3>
<p align="left">Spot-On integrates an independent and self-contained
classical McEliece implementation. The implementation is based on the
software and writings of Antoon Bosselaers, René Govaerts, Robert
McEliece, Bart Preneel, Marek Repka, Christopher Roering, Joos
Vandewalle.</p>
<p align="left">Some general information. Spot-On supports m value 11
and t value 51. For m = 11 and t = 51, k = 1487 and n = 2048. As a
result, the message expansion factor is approximately 1.4.</p>
<p align="left">A private keys consists of matrices P<sup>-1</sup>
and S<sup>-1</sup>, the code support L, a binary irreducible Goppa
polynomial g, and a vector. The matrices contain 2048 x 2048 and 1487
x 1487 entries, respectively. The polynomial contains 51 entries. The
vector contains 2048 entries. A total of 6,407,572 entries are
required. As many as 12,873,361 bytes may be consumed by a private
key. Approximately 74 MiB are required for housing six McEliece
private keys.</p>
<p align="left">A public key consists of matrix <font face="Liberation Serif, serif">Ĝ</font>
and t. A total of 1487 x 2048, or 3,045,376, entries are required. As
many as 6,093,750 bytes are consumed.</p>
<p align="left">Included is an interpretation, model a, of the
Fujisaki-Okamoto conversion. Please see
<a class="western" href="https://www.emsec.rub.de/media/attachments/files/2013/03/mastersthesis-hudde-code-based-cryptography-library.pdf">https://www.emsec.rub.de/media/attachments/files/2013/03/mastersthesis-hudde-code-based-cryptography-library.pdf</a>
for more details. The key streams referenced in the aforementioned
paper are generated via single-round PBKDF2 and SHA-512. The
generated 64-byte salts are transferred as clear text. Computation
errors abort the processes.</p>
<p align="left">Decryption</p>
<ol>
	<li/>
<p align="left">Decrypt, via McEliece, c<sub>1</sub> to obtain
	the original message m.</p>
	<li/>
<p align="left">Compute the original error vector e via e = c<sub>1</sub>
	– m * <font face="Liberation Serif, serif">Ĝ</font>.</p>
	<li/>
<p align="left">Compute the SHA-512 digest of e.</p>
	<li/>
<p align="left">Apply the previously-computed digest to a
	single round of the PBKDF2 function. The generated key stream, k<sub>2</sub>,
	will contain 1488 bits of which the first 1487 will be consumed in
	the following computation. The 64-byte salt, s<sub>2</sub>, is
	provided to PBKDF2.</p>
	<li/>
<p align="left">Compute mcar = c<sub>2</sub> xor k<sub>2</sub>.</p>
	<li/>
<p align="left">Compute the SHA-512 digest of e || mcar.</p>
	<li/>
<p align="left">Apply the previously-computed digest to a
	single round of the PBKDF2 function. The generated key stream, k<sub>1</sub>,
	will contain 1488 bits of which the first 1487 will be consumed in
	the following computation. The 64-byte salt, s<sub>1</sub>, is
	provided to PBKDF2.</p>
	<li/>
<p align="left">Verify that c<sub>1</sub> = k<sub>1</sub> * <font face="Liberation Serif, serif">Ĝ</font>
	+ e.</p>
</ol>
<p align="left">Encryption</p>
<ol>
	<li/>
<p align="left">Generate a random vector e of length n. The
	vector e will contain t randomly-dispersed ones.</p>
	<li/>
<p align="left">Compute the SHA-512 digest of e || m, where m
	is the original message.</p>
	<li/>
<p align="left">Apply the previously-computed digest to a
	single round of the PBKDF2 function. The generated key stream, k<sub>1</sub>,
	will contain 1488 bits of which the first 1487 will be consumed in
	the following computation. A 64-byte weakly-derived salt, s<sub>1</sub>,
	is provided to PBKDF2.</p>
	<li/>
<p align="left">Compute c<sub>1</sub> = k<sub>1</sub> * <font face="Liberation Serif, serif">Ĝ</font>
	+ e.</p>
	<li/>
<p align="left">Compute the SHA-512 digest of e.</p>
	<li/>
<p align="left">Apply the previously-computed digest to a
	single round of the PBKDF2 function. The generated key stream, k<sub>2</sub>,
	will contain 1488 bits of which the first 1487 will be consumed in
	the following computation. A 64-byte weakly-derived salt, s<sub>2</sub>,
	is provided to PBKDF2.</p>
	<li/>
<p align="left">Compute c<sub>2</sub> = k<sub>2</sub> xor m.</p>
	<li/>
<p align="left">Transfer c<sub>1</sub>, c<sub>2</sub>, s<sub>1</sub>,
	and s<sub>2</sub>.</p>
</ol>
<p align="left">Included is an interpretation, model b, of the
Fujisaki-Okamoto conversion. Please see
<a class="western" href="https://www.emsec.rub.de/media/attachments/files/2013/03/mastersthesis-hudde-code-based-cryptography-library.pdf">https://www.emsec.rub.de/media/attachments/files/2013/03/mastersthesis-hudde-code-based-cryptography-library.pdf</a>
for more details. The key streams referenced in the aforementioned
paper are generated via SHAKE-256. libgcrypt 1.7.0 or newer is
required. Computation errors abort the processes.</p>
<p align="left">Decryption</p>
<ol>
	<li/>
<p align="left">Decrypt, via McEliece, c<sub>1</sub> to obtain
	the original message m.</p>
	<li/>
<p align="left">Compute the original error vector e via e = c<sub>1</sub>
	– m * <font face="Liberation Serif, serif">Ĝ</font>.</p>
	<li/>
<p align="left">Compute the SHAKE-256 digest of e. The
	generated key stream, k<sub>2</sub>, will contain 1488 bits of which
	the first 1487 will be consumed in the following computation.</p>
	<li/>
<p align="left">Compute mcar = c<sub>2</sub> xor k<sub>2</sub>.</p>
	<li/>
<p align="left">Compute the SHAKE-256 digest of e || mcar. The
	generated key stream, k<sub>1</sub>, will contain 1488 bits of which
	the first 1487 will be consumed in the following computation.</p>
	<li/>
<p align="left">Verify that c<sub>1</sub> = k<sub>1</sub> * <font face="Liberation Serif, serif">Ĝ</font>
	+ e.</p>
</ol>
<p align="left">Encryption</p>
<ol>
	<li/>
<p align="left">Generate a random vector e of length n. The
	vector e will contain t randomly-dispersed ones.</p>
	<li/>
<p align="left">Compute the SHAKE-256 digest of e || m, where
	m is the original message. The generated key stream, k<sub>1</sub>,
	will contain 1488 bits of which the first 1487 will be consumed in
	the following computation.</p>
	<li/>
<p align="left">Compute c<sub>1</sub> = k<sub>1</sub> * <font face="Liberation Serif, serif">Ĝ</font>
	+ e.</p>
	<li/>
<p align="left">Compute the SHAKE-256 digest of e. The
	generated key stream, k<sub>2</sub>, will contain 1488 bits of which
	the first 1487 will be consumed in the following computation.</p>
	<li/>
<p align="left">Compute c<sub>2</sub> = k<sub>2</sub> xor m.</p>
	<li/>
<p align="left">Transfer c<sub>1</sub> and c<sub>2</sub>.</p>
</ol>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="font-style: normal; page-break-before: always"><a name="__RefHeading__299_1157459078"></a>
Multiple Devices</h3>
<p align="left" style="font-style: normal">Spot-On allows identical
representations of individual nodes across multiple devices. For
example, one may configure a node on one device and copy the
configuration to another device.</p>
<p align="left" style="font-style: normal"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1195_307987230"></a>
Non-Volatile Congestion Control Memory</h3>
<p align="left">Limited-memory devices may benefit from non-volatile
congestion-control storage. Spot-On provides a mode where message
digests are temporarily stored in a local SQLite database. Please see
<a class="western" href="https://www.sqlite.org/wal.html">https://www.sqlite.org/wal.html</a>
and  <a class="western" href="https://www.sqlite.org/pragma.html#pragma_synchronous">https://www.sqlite.org/pragma.html#pragma_synchronous</a>.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1209_1984784944"></a>
NTL</h3>
<p align="left">The NTL library is required if the McEliece
cryptographic system is desired. A modified form of the library’s
source is included in the source repository. The modifications
include the removal of GMP support and the resolution of some
compiler warnings. On OS X, Homebrew should be used to install the
library and its dependencies. Generally, brew install ntl. On
Unix-like and Windows systems, a shared form of the library is
prepared during the compilation of Spot-On. The initial preparation
process may require a significant time to complete. NTL source is
available at <a class="western" href="http://www.shoup.net/ntl">http://www.shoup.net/ntl</a>.
Please configure the NTL library with exceptions enabled (DoConfig).
Please read the Documentation/MCELIECE document for additional
information.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1036_18893826"></a>
Pass-through Devices</h3>
<p align="left">Spot-On supports pass-through connections.
Pass-through connections allow data travel without alterations.
Please note that accounts are supported for such connections. All
other data interactions, including capabilities announcements, cannot
be supported.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__253_527466761"></a>
Poptastic</h3>
<p align="left">Version 0.17 of Spot-On introduced Poptastic. The new
mechanism allows participants to communicate via the IMAP, POP3, and
SMTP protocols. Poptastic provides a medium for near real-time
conversations as well as traditional e-mail. Please note that
Poptastic does not support the two-way calling mechanism.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__169_1115980955"></a>
Public Key Infrastructure</h3>
<p align="left">Spot-On utilizes the libgcrypt and libntru libraries
for permanent private and public key pairs. Presently, the
application generates ten key pairs during the initialization
process. Key generation is optional. Consequently, Spot-On does not
require a public key infrastructure.</p>
<p align="left">ElGamal, McEliece, NTRU, and RSA encryption
algorithms are supported. DSA, ECDSA, EdDSA, ElGamal, and RSA
signature algorithms are supported. The OAEP and PSS schemes are used
with RSA encryption and RSA signing, respectively.</p>
<p align="left">Communications between nodes having diverse key types
are well-defined if the nodes share common libgcrypt and libntru
libraries.</p>
<p align="left">Non-McEliece and Non-NTRU private keys are evaluated
for correctness via the gcry_pk_testkey() function. Public keys must
also meet some basic criteria such as including the public-key
identifier.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1516_1997043320"></a>
Public Key Sharing</h3>
<p align="left">In addition to the Echo Public Key Sharing, Spot-On
offers a multitude of key-sharing methods. Keys may be shared via
network connections. Keys may be exported to a system’s clipboard
buffer and imported via the user interface, that is, copy-and-paste.
Keys may also be exported and imported via text files.</p>
<p align="left">Public key pairs are validated whenever they are
imported via the kernel and the user interface. As some cryptographic
algorithms lack signature properties, keys inserted via network
connections are temporarily accepted. Key-acceptance is optional. The
Echo Public Key Sharing algorithm offers its own permissions.</p>
<p align="left">Spot-On also includes a mechanism for exporting a
specific key-pair using a specific participant’s credentials, a
so-called Repleo. A repleo is a public-key bundle which contains
authentically-encrypted data. Only a designated participant will be
able to process a repleo.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1373_1503577792"></a>
Secure Memory</h3>
<p align="left">Spot-On supports secure memory through libgcrypt.
Both the kernel and the user interface processes may be configured to
use secure memory. If secure memory is not necessary, simply set the
appropriate setting to zero. Please note that operating systems may
impose restrictions on the amount of memory that may be reserved.
Please also note that Spot-On cannot guarantee the permanence of
locked memory. Also, logical regions exist where private data are
placed into QByteArray objects.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc631_61244466"></a>
Sessions</h3>
<p align="left">Excluding Forward Secrecy, SMP, accounts, and
congestion control, Spot-On does not maintain a deliberate state
system with respect to communications. Some portions of the system
provide the user with state information, however, the information is
not required for the health and stability of Spot-On communications.
Shared cryptographic data is maintained in authentically-encrypted
containers.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__330_678579420"></a>
Socialist Millionaire Protocol</h3>
<p align="left">As of version 0.19, Spot-On includes an asynchronous
implementation of the Socialist Millionaire Protocol as defined by
<a class="western" href="https://otr.cypherpunks.ca/Protocol-v3-4.0.0.html">https://otr.cypherpunks.ca/Protocol-v3-4.0.0.html</a>.
Spot-On uses the SHA-512 of the secrets as the x and y components.
SHA-512 is also used during proof assembly and validation.</p>
<p align="left">Assuming that Alice begins the exchange:</p>
<ul>
	<li/>
<p style="margin-bottom: 0in">Alice: 
	</p>
	<ol>
		<li/>
<p style="margin-bottom: 0in">Picks random exponents a<sub>2</sub>
		and a<sub>3</sub> 
		</p>
		<li/>
<p style="margin-bottom: 0in">Sends Bob g<sub>2a</sub> = g<sub>1</sub><sup>a</sup><sub>2</sub>
		and g<sub>3a</sub> = g<sub>1</sub><sup>a</sup><sub>3</sub> 
		</p>
	</ol>
	<li/>
<p style="margin-bottom: 0in">Bob: 
	</p>
	<ol>
		<li/>
<p style="margin-bottom: 0in">Picks random exponents b<sub>2</sub>
		and b<sub>3</sub> 
		</p>
		<li/>
<p style="margin-bottom: 0in">Computes g<sub>2b</sub> = g<sub>1</sub><sup>b</sup><sub>2</sub>
		and g<sub>3b</sub> = g<sub>1</sub><sup>b</sup><sub>3</sub> 
		</p>
		<li/>
<p style="margin-bottom: 0in">Computes g<sub>2</sub> = g<sub>2a</sub><sup>b</sup><sub>2</sub>
		and g<sub>3</sub> = g<sub>3a</sub><sup>b</sup><sub>3</sub> 
		</p>
		<li/>
<p style="margin-bottom: 0in">Picks random exponent r 
		</p>
		<li/>
<p style="margin-bottom: 0in">Computes P<sub>b</sub> = g<sub>3</sub><sup>r</sup>
		and Q<sub>b</sub> = g<sub>1</sub><sup>r</sup> g<sub>2</sub><sup>y</sup>
				</p>
		<li/>
<p style="margin-bottom: 0in">Sends Alice g<sub>2b</sub>,
		g<sub>3b</sub>, P<sub>b</sub> and Q<sub>b</sub> 
		</p>
	</ol>
	<li/>
<p style="margin-bottom: 0in">Alice: 
	</p>
	<ol>
		<li/>
<p style="margin-bottom: 0in">Computes g<sub>2</sub> = g<sub>2b</sub><sup>a</sup><sub>2</sub>
		and g<sub>3</sub> = g<sub>3b</sub><sup>a</sup><sub>3</sub> 
		</p>
		<li/>
<p style="margin-bottom: 0in">Picks random exponent s 
		</p>
		<li/>
<p style="margin-bottom: 0in">Computes P<sub>a</sub> = g<sub>3</sub><sup>s</sup>
		and Q<sub>a</sub> = g<sub>1</sub><sup>s</sup> g<sub>2</sub><sup>x</sup>
				</p>
		<li/>
<p style="margin-bottom: 0in">Computes R<sub>a</sub> = (Q<sub>a</sub>
		/ Q<sub>b</sub>) <sup>a</sup><sub>3</sub> 
		</p>
		<li/>
<p style="margin-bottom: 0in">Sends Bob P<sub>a</sub>, Q<sub>a</sub>
		and R<sub>a</sub> 
		</p>
	</ol>
	<li/>
<p style="margin-bottom: 0in">Bob: 
	</p>
	<ol>
		<li/>
<p style="margin-bottom: 0in">Computes R<sub>b</sub> = (Q<sub>a</sub>
		/ Q<sub>b</sub>) <sup>b</sup><sub>3</sub> 
		</p>
		<li/>
<p style="margin-bottom: 0in">Computes R<sub>ab</sub> = R<sub>a</sub><sup>b</sup><sub>3</sub>
				</p>
		<li/>
<p style="margin-bottom: 0in">Checks whether R<sub>ab</sub>
		== (P<sub>a</sub> / P<sub>b</sub>) 
		</p>
		<li/>
<p style="margin-bottom: 0in">Sends Alice R<sub>b</sub> 
		</p>
	</ol>
	<li/>
<p style="margin-bottom: 0in">Alice: 
	</p>
	<ol>
		<li/>
<p style="margin-bottom: 0in">Computes R<sub>ab</sub> = R<sub>b</sub><sup>a</sup><sub>3</sub>
				</p>
		<li/>
<p style="margin-bottom: 0in">Checks whether R<sub>ab</sub>
		== (P<sub>a</sub> / P<sub>b</sub>) 
		</p>
	</ol>
	<li/>
<p>If everything is done correctly, then R<sub>ab</sub> should
	hold the value of (P<sub>a</sub> / P<sub>b</sub>) times (g<sub>2</sub><sup>a</sup><sub>3</sub><sup>b</sup><sub>3</sub>)<sup>(x
	- y)</sup>, which means that the test at the end of the protocol
	will only succeed if x == y. Further, since g<sub>2</sub><sup>a</sup><sub>3</sub><sup>b</sup><sub>3</sub>
	is a random number not known to any party, if x is not equal to y,
	no other information is revealed.</p>
</ul>
<p><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc1097_1460767439"></a>
Sources of Entropy</h3>
<p align="left">Spot-On nodes may be configured as sources of
entropy. Private peers must export one or more connection points and
enable the randomness-source mechanisms. Remote peers should then
connect to the private peers via Half-Echo agreements. Be careful of
malicious entropy!</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading__230_1536820662"></a>
Two-Way Calling</h3>
<p align="left">Spot-On implements a plain two-pass key-distribution
system. The protocol is defined as follows:</p>
<ol>
	<li/>
<p align="left">A peer generates 128-bit AES and 256-bit
	SHA-512 keys via the system's cryptographic random number generator.</p>
	<li/>
<p align="left">Using the destination's public key, the peer
	encapsulates the two keys via the hybrid cryptographic system.</p>
	<li/>
<p align="left">The destination peer receives the data,
	records it, and generates separate keys as in step 1.</p>
	<li/>
<p align="left">The destination peer transmits the
	encapsulated keys to the originating peer as in step 2.</p>
</ol>
<p align="left">Once the protocol is executed, the two peers shall
possess identical authentication and encryption keys. Please note
that duplicate half-keys are allowed.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc842_866388615"></a>
Verifying Ownership of Public Keys</h3>
<p align="left">A shared public key bundle includes the encryption
public key, a signature of the encryption public key, the signature
public key, and a signature of the signature public key. Ownership of
McEliece and NTRU encryption keys is not verified. Signatures are
generated as follows:</p>
<ol>
	<li/>
<p align="left">The encryption or signature public key is
	gathered and stored in <i>data_t</i><span style="font-style: normal">.</span></p>
	<li/>
<p align="left">The SHA-512 digest of the public key is
	computed and stored in <i>hash</i><span style="font-style: normal">.</span></p>
	<li/>
<p align="left" style="font-style: normal">For DSA, Elliptic
	Curve DSA, and ElGamal public keys:</p>
	<ol>
		<li/>
<p align="left" style="font-style: normal">gcry_sexp_build(&amp;data_t,
		0,</p>
		<p align="left" style="font-style: normal">&quot;(data (flags
		raw)(value %m))&quot;,</p>
		<p align="left" style="font-style: normal">hash_t) is computed.</p>
	</ol>
	<li/>
<p align="left">For Edward Curve DSA public keys:</p>
	<ol>
		<li/>
<p align="left">gcry_sexp_build(&amp;data_t, 0,</p>
		<p align="left">&quot;(data (flags eddsa)(hash-algo sha512)&quot;</p>
		<p align="left">&quot;(value %b))&quot;,</p>
		<p align="left">hash.length(),</p>
		<p align="left">hash.constData()) is computed.</p>
	</ol>
	<li/>
<p align="left">For RSA public keys:</p>
	<ol>
		<li/>
<p align="left">gcry_sexp_build(&amp;data_t, 0,</p>
		<p align="left">&quot;(data (flags pss)(hash sha512 %b)&quot;</p>
		<p align="left">&quot;(random-override %b))&quot;,</p>
		<p align="left">hash.length(),</p>
		<p align="left">hash.constData(),</p>
		<p align="left">random.length(),</p>
		<p align="left">random.constData()) is computed, where the variable
		<i>random</i><span style="font-style: normal"> contains 20 bytes of
		random data.</span></p>
	</ol>
	<li/>
<p align="left"><span style="font-style: normal">Finally,
	gcry_pk_sign(&amp;signature_t, data_t, key_t) is computed. </span><span style="font-style: normal">The
	contents of</span><span style="font-style: normal"> </span><i>signature_t</i><span style="font-style: normal">
	are extracted via gcry_sexp_sprint() and stored in a byte array. </span><span style="font-style: normal">The
	variable </span><i>key_t</i><span style="font-style: normal">
	contains either the public encryption key or the public signature
	key.</span></p>
</ol>
<p align="left" style="font-style: normal">Signatures are verified as
follows:</p>
<ol>
	<li/>
<p align="left"><span style="font-style: normal">The SHA-512
	</span><span style="font-style: normal">digest </span><span style="font-style: normal">of
	the provided public key is computed </span><span style="font-style: normal">and
	stored in </span><i>hash</i><span style="font-style: normal">.</span></p>
	<li/>
<p align="left" style="font-style: normal">For DSA, Elliptic
	Curve DSA, and ElGamal public keys:</p>
	<ol>
		<li/>
<p align="left" style="font-style: normal">gcry_sexp_build(&amp;data_t,
		0,</p>
		<p align="left" style="font-style: normal">&quot;(data (flags
		raw)(value %m))&quot;,</p>
		<p align="left"><span style="font-style: normal">hash_t) is
		computed. </span><span style="font-style: normal">The contents of
		</span><i>hash_t</i><span style="font-style: normal"> are populated
		via gcry_mpi_scan().</span></p>
	</ol>
	<li/>
<p align="left">For Edward Curve DSA public keys:</p>
	<ol>
		<li/>
<p align="left">gcry_sexp_build(&amp;data_t, 0,</p>
		<p align="left">&quot;(data (flags eddsa)(hash-algo sha512)&quot;</p>
		<p align="left">&quot;(value %b))&quot;,</p>
		<p align="left">hash.length(),</p>
		<p align="left">hash.constData()) is computed.</p>
	</ol>
	<li/>
<p align="left">For RSA public keys:</p>
	<ol>
		<li/>
<p align="left">gcry_sexp_build(&amp;data_t, 0,</p>
		<p align="left">&quot;(data (flags pss)(hash sha512 %b)&quot;</p>
		<p align="left">&quot;(random-override %b))&quot;,</p>
		<p align="left">hash.length(),</p>
		<p align="left">hash.constData(),</p>
		<p align="left">random.length(),</p>
		<p align="left"><span style="font-style: normal">random.constData())
		is computed, </span><span style="font-style: normal">where the
		</span><span style="font-style: normal">variable </span><i>random</i><span style="font-style: normal">
		contains 20 bytes of random data.</span></p>
	</ol>
	<li/>
<p align="left"><span style="font-style: normal">F</span><span style="font-style: normal">inally,
	gcry_pk_verify(signature_t, data_t, key_t) is computed. If
	gcry_pk_verify() </span><span style="font-style: normal">returns
	zero</span><span style="font-style: normal">, the signature is
	considered valid. The contents of </span><i>signature_t</i><span style="font-style: normal">
	are populated via gcry_sexp_new() using the provided signature
	array.</span></p>
</ol>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc839_866388615"></a>
Wide Lanes</h3>
<p align="left">One of the many obligations of a Spot-On-Kernel
process is to receive, process, and forward data to one or more
nodes. The mechanism that performs this task is similar to both a
network hub and a network switch. Wide Lanes allow node operators to
assign listener lane widths. Let's consider a basic example, a
listener having a lane width of 20,000 bytes. The kernel, if
necessary, will forward packets via the listener's clients if the
sizes of the forwarded packets do not exceed 20,000 bytes.
Optionally, clients may negotiate different lane widths with their
peers. All network communications beyond the interface and the kernel
must and will adhere to the configured limits.</p>
<p align="left"><br/>
<br/>

</p>
<h3 class="western" align="center" style="page-break-before: always"><a name="__RefHeading___Toc748_390620771"></a>
References</h3>
<p align="left"><a class="western" href="http://world.std.com/~dtd/sign_encrypt/sign_encrypt7.html">http://world.std.com/~dtd/sign_encrypt/sign_encrypt7.html</a></p>
<p align="left"><a class="western" href="https://en.wikipedia.org/wiki/Authenticated_encryption">https://en.wikipedia.org/wiki/Authenticated_encryption</a></p>
<p align="left"><a class="western" href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation</a></p>
<p align="left"><a class="western" href="https://en.wikipedia.org/wiki/Ciphertext_stealing">https://en.wikipedia.org/wiki/Ciphertext_stealing</a></p>
<p align="left"><a class="western" href="https://en.wikipedia.org/wiki/Hybrid_cryptosystem">https://en.wikipedia.org/wiki/Hybrid_cryptosystem</a></p>
<p align="left"><a class="western" href="https://en.wikipedia.org/wiki/NTRU">https://en.wikipedia.org/wiki/NTRU</a></p>
<p align="left"><a class="western" href="https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding">https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding</a></p>
<p align="left"><a class="western" href="https://en.wikipedia.org/wiki/PKCS_1">https://en.wikipedia.org/wiki/PKCS_1</a></p>
<p align="left"><a class="western" href="https://en.wikipedia.org/wiki/Padding_%28cryptography%29">https://en.wikipedia.org/wiki/Padding_%28cryptography%29</a></p>
<p align="left"><a class="western" href="https://en.wikipedia.org/wiki/Stream_Control_Transmission_Protocol">https://en.wikipedia.org/wiki/Stream_Control_Transmission_Protocol</a></p>
<p align="left"><a class="western" href="https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm">https://en.wikipedia.org/wiki/Time-based_One-time_Password_Algorithm</a></p>
<p align="left"><a class="western" href="https://en.wikipedia.org/wiki/Timing_attackhttps://en.wikipedia.org/wiki/Timing_attack">https://en.wikipedia.org/wiki/Timing_attackhttps://en.wikipedia.org/wiki/Timing_attack</a></p>
<p align="left"><a class="western" href="https://eprints.qut.edu.au/35665/1/c35665.pdf">https://eprints.qut.edu.au/35665/1/c35665.pdf</a></p>
<p align="left"><a class="western" href="https://gnupg.org/documentation/manuals/gcrypt">https://gnupg.org/documentation/manuals/gcrypt</a></p>
<p align="left"><a class="western" href="https://otr.cypherpunks.ca/Protocol-v3-4.0.0.html">https://otr.cypherpunks.ca/Protocol-v3-4.0.0.html</a></p>
<p align="left"><a class="western" href="https://www.cs.jhu.edu/~astubble/dss/ae.pdf">https://www.cs.jhu.edu/~astubble/dss/ae.pdf</a></p>
<p align="left"><br/>
<br/>

</p>
</body>
</html>